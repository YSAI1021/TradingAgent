import{r as f,j as e}from"./vendor-W84mhc-l.js";import{b as H}from"./router-C1wKTLYl.js";import{b as z,a as L,E as O,B as I}from"./index-BRQ3_4kF.js";import{C as P,c as D,a as E,b as F}from"./card-CpwL0RW4.js";import{S as G}from"./separator-CEasVtJw.js";import{T as B,a as J,b as R,c as $}from"./tabs-C4wPHsvs.js";import{D as X,a as K,b as Q,c as q}from"./dialog-Bor2lZTe.js";import{p as U,T as _,m as Z,n as ee,L as se,S as te,F as ae,i as ne}from"./icons-DPUJRDi7.js";import{R as re,L as ie,b as oe,X as ce,Y as le,T as de,c as me}from"./recharts-DzyiCK6h.js";import"./radix-CnjOkeCj.js";const W=[{id:"1D",range:"1d",interval:"5m",label:"1D"},{id:"5D",range:"5d",interval:"15m",label:"5D"},{id:"1M",range:"1mo",interval:"1d",label:"1M"},{id:"6M",range:"6mo",interval:"1d",label:"6M"},{id:"YTD",range:"ytd",interval:"1d",label:"YTD"},{id:"1Y",range:"1y",interval:"1d",label:"1Y"},{id:"5Y",range:"5y",interval:"1wk",label:"5Y"},{id:"Max",range:"max",interval:"1mo",label:"Max"}];function he(t,s){const o=new Date(t*1e3);return s==="1d"||s==="5d"?o.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):s==="5y"||s==="max"?o.toLocaleDateString("en-US",{month:"short",year:"2-digit"}):o.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function ge(t,s){const o=new Date(t*1e3);return s==="1d"||s==="5d"?o.toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):o.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}const xe="https://query1.finance.yahoo.com/v8/finance/chart";async function pe(t,s,o){var k,i,C,S,A;const n=new URLSearchParams({range:s,interval:o}),d=`${xe}/${t}?${n}`,p=`/api/chart/v8/finance/chart/${t}?${n}`;let r,b=!0;try{if(r=await fetch(p),!r.ok)throw console.warn("[Chart] Proxy request failed:",r.status,r.statusText),new Error(`Proxy: ${r.status} ${r.statusText}`)}catch(m){console.warn("[Chart] Proxy fetch failed, trying CORS fallback:",m),b=!1;const c=`https://api.allorigins.win/raw?url=${encodeURIComponent(d)}`;r=await fetch(c)}const j=await r.text();console.log("[Chart] Response status:",r.status,"Used proxy:",b);let h;try{h=JSON.parse(j)}catch{throw console.error("[Chart] Invalid JSON response:",j.slice(0,500)),new Error(`Invalid JSON (status ${r.status})`)}const v=(i=(k=h==null?void 0:h.chart)==null?void 0:k.result)==null?void 0:i[0];if(!v)throw console.error("[Chart] Unexpected data shape:",JSON.stringify(h).slice(0,800)),new Error("Invalid chart data structure");const y=v.timestamp??[],g=(S=(C=v.indicators)==null?void 0:C.quote)==null?void 0:S[0],l=(g==null?void 0:g.close)??[],N=((A=v.meta)==null?void 0:A.previousClose)??l[0],w=[];for(let m=0;m<y.length;m++){const c=l[m];if(c==null)continue;const T=c-N,M=N?T/N*100:0;w.push({timestamp:y[m],date:he(y[m],s),time:ge(y[m],s),close:c,change:T,changePercent:M})}if(w.length===0)throw console.warn("[Chart] No data points parsed. timestamps:",y.length,"closes:",l.length),new Error("No chart data points");return w}function ue({active:t,payload:s,label:o,range:n}){if(!t||!(s!=null&&s.length))return null;const d=s[0].payload,p=d.change>=0;return e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white px-4 py-3 shadow-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:d.time}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["$",d.close.toFixed(2)]}),e.jsxs("p",{className:`text-sm font-medium ${p?"text-green-600":"text-red-600"}`,children:[p?"+":"",d.change.toFixed(2)," (",p?"+":"",d.changePercent.toFixed(2),"%)"]})]})}function Se(){const{symbol:t="AAPL"}=H(),[s,o]=f.useState(W[2]),[n,d]=f.useState([]),[p,r]=f.useState(!0),[b,j]=f.useState(null),h=()=>{r(!0),j(null);const a=s.range,x=s.interval;console.log("[Chart] Fetching",t,s.id,"→",a,x),pe(t,a,x).then(u=>{d(u),console.log("[Chart] Loaded",u.length,"data points")}).catch(u=>{const Y=u instanceof Error?u.message:String(u);j(Y),console.error("[Chart] Fetch error:",u)}).finally(()=>r(!1))},{quotes:v}=z([t]),g={AAPL:{name:"Apple Inc.",sector:"Technology"},MSFT:{name:"Microsoft Corp.",sector:"Technology"},GOOGL:{name:"Alphabet Inc.",sector:"Technology"},XOM:{name:"Exxon Mobil",sector:"Energy"},JPM:{name:"JPMorgan Chase",sector:"Finance"},NVDA:{name:"NVIDIA Corp.",sector:"Technology"},TSLA:{name:"Tesla Inc.",sector:"Auto"},META:{name:"Meta Platforms",sector:"Technology"},DIS:{name:"Walt Disney",sector:"Media"}}[t]??{name:t,sector:"—"},l=v[t],N={AAPL:228.52,MSFT:415.5,GOOGL:173.28,XOM:118.45,JPM:198.3,NVDA:141.2,TSLA:263.45,META:585.3,DIS:118.9},w=n.length>0?n[n.length-1].close:null,k=n.length>=2?(n[n.length-1].close-n[0].close)/n[0].close*100:(l==null?void 0:l.changePercent)??0,i={...g,price:(l==null?void 0:l.price)??w??N[t]??0,change:k};f.useEffect(()=>{h()},[t,s.id]);const C=n.length>=2?n[n.length-1].close>=n[0].close?"#22c55e":"#ef4444":"#6b7280",[S,A]=f.useState(!1),c={AAPL:{business:"Apple designs, manufactures, and sells consumer electronics, software, and services. The company's product lineup includes the iPhone, Mac, iPad, Apple Watch, and services like the App Store, Apple Music, and iCloud.",industry:"Technology / Consumer Electronics",products:"iPhone, Mac, iPad, Apple Watch, AirPods, Apple TV, Services (App Store, Apple Music, iCloud)",marketPosition:"World's largest company by market cap. Dominant in premium smartphone segment with strong ecosystem lock-in.",recentDevelopments:"Apple Intelligence AI integration across devices. Growing services revenue. Expansion in India and emerging markets."},MSFT:{business:"Microsoft develops and licenses software, cloud services, and hardware. Core products include Windows, Office 365, Azure cloud, Xbox, and LinkedIn.",industry:"Technology / Software & Cloud",products:"Windows, Office 365, Azure, Teams, Dynamics 365, Xbox, GitHub, LinkedIn",marketPosition:"Leading cloud provider (Azure). Dominant in enterprise software and productivity tools.",recentDevelopments:"Copilot AI across product suite. Strong Azure growth. Gaming and Activision acquisition."},GOOGL:{business:"Alphabet (Google) operates search, advertising, cloud, and consumer products. Core revenue comes from digital advertising and cloud services.",industry:"Technology / Internet & Advertising",products:"Google Search, YouTube, Google Cloud, Android, Chrome, Pixel devices",marketPosition:"Dominant in search and digital advertising. Major cloud player. Leading in AI research.",recentDevelopments:"Gemini AI integration. Cloud growth. Ongoing antitrust scrutiny."},XOM:{business:"Exxon Mobil explores, produces, and refines oil and gas. Operates across upstream, downstream, and chemical segments globally.",industry:"Energy / Oil & Gas",products:"Crude oil, natural gas, refined fuels, lubricants, petrochemicals",marketPosition:"One of the largest integrated oil companies. Strong dividend history.",recentDevelopments:"Carbon capture investments. Guyana and Permian production growth."},JPM:{business:"JPMorgan Chase provides banking, asset management, and investment services. Operates consumer, commercial, and investment banking.",industry:"Finance / Banking",products:"Consumer banking, credit cards, mortgages, investment banking, asset management",marketPosition:"Largest U.S. bank by assets. Leader in investment banking and trading.",recentDevelopments:"Strong net interest income. Wealth management growth. Fed stress test performance."},NVDA:{business:"NVIDIA designs GPUs for gaming, data centers, and AI. Dominant in AI training chips and accelerated computing.",industry:"Technology / Semiconductors",products:"GeForce GPUs, Data Center GPUs (A100, H100), AI software, Omniverse",marketPosition:"Market leader in AI chips. Near-monopoly in data center AI accelerators.",recentDevelopments:"Record data center revenue. Blackwell chip ramp. AI infrastructure demand."},TSLA:{business:"Tesla designs and manufactures electric vehicles, energy storage, and solar products. Also developing FSD and robotics.",industry:"Auto / Electric Vehicles",products:"Model S, 3, X, Y, Cybertruck, Megapack, Powerwall, Solar",marketPosition:"Largest EV maker by volume. Leader in battery tech and charging network.",recentDevelopments:"FSD rollout. Cybertruck production. Robotaxi ambitions."},META:{business:"Meta Platforms operates social and communication apps including Facebook, Instagram, WhatsApp, and Reality Labs for VR/AR.",industry:"Technology / Social Media & Advertising",products:"Facebook, Instagram, WhatsApp, Messenger, Quest VR, Ray-Ban Meta",marketPosition:"Largest social media company. Leader in digital advertising reach.",recentDevelopments:"AI assistant rollout. Metaverse investments. Strong ad revenue recovery."},DIS:{business:"Walt Disney operates media networks, theme parks, and streaming (Disney+, Hulu, ESPN+). Creates films, TV, and entertainment content.",industry:"Media / Entertainment",products:"Disney+, Hulu, ESPN+, Theme parks, studios, linear TV networks",marketPosition:"Leading entertainment conglomerate. Major streaming subscriber base.",recentDevelopments:"Streaming profitability focus. ESPN strategic options. Box office recovery."}}[t]??{business:`${g.name} operates in the ${g.sector} sector. Further details can be found in company filings and investor relations.`,industry:g.sector,products:"Key products and services available in company reports.",marketPosition:"Market position varies by segment and geography.",recentDevelopments:"Check latest earnings and news for recent developments."},T=[{theme:"Strong Q4 Earnings",sentiment:"Positive",articles:12},{theme:"AI Integration",sentiment:"Positive",articles:8},{theme:"Supply Chain Concerns",sentiment:"Neutral",articles:5}],M=[{metric:"Direct Exposure",value:"35% of portfolio"},{metric:"Sector Exposure",value:"65% in Tech"},{metric:"Correlation Risk",value:"High with MSFT, GOOGL"}],V=[{source:"Price Chart",evidence:`${t} has maintained positive momentum versus the start of the selected period.`,confidence:"Medium"},{source:"RAG News Retrieval",evidence:"Theme analysis is based on recent retrieved news covering earnings, product, and supply-chain events.",confidence:"Medium"},{source:"Portfolio Exposure",evidence:"This holding has high portfolio impact and strong correlation with your tech exposure.",confidence:"High"}];return e.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:t}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>A(!0),className:"ml-2",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Company Overview"]})]}),e.jsx("p",{className:"text-gray-500",children:i.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[e.jsxs("span",{className:"text-2xl font-semibold text-gray-900",children:["$",(i.price??0).toFixed(2)]}),e.jsxs("span",{className:`flex items-center gap-1 text-lg ${(i.change??0)>0?"text-green-600":(i.change??0)<0?"text-red-600":"text-gray-500"}`,children:[(i.change??0)>0?e.jsx(_,{className:"w-5 h-5"}):(i.change??0)<0?e.jsx(Z,{className:"w-5 h-5"}):e.jsx(ee,{className:"w-5 h-5"}),(i.change??0)>0?"+":"",(i.change??0).toFixed(2),"%"]})]})]}),e.jsx(X,{open:S,onOpenChange:A,children:e.jsxs(K,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[e.jsx(Q,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),t," — Company Overview"]})}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"What the Company Does"}),e.jsx("p",{className:"text-gray-700",children:c.business})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Industry & Sector"}),e.jsx("p",{className:"text-gray-700",children:c.industry})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Key Products & Services"}),e.jsx("p",{className:"text-gray-700",children:c.products})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Market Position"}),e.jsx("p",{className:"text-gray-700",children:c.marketPosition})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Recent Developments"}),e.jsx("p",{className:"text-gray-700",children:c.recentDevelopments})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx(O,{items:[{source:"Company Overview",evidence:"Company overview is generated from sector, product, and recent development context.",confidence:"Medium"}]})})]})]})}),e.jsx(P,{className:"mb-6",children:e.jsxs(D,{className:"pt-6",children:[e.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:W.map(a=>e.jsx(L,{variant:s.id===a.id?"default":"ghost",size:"sm",className:`h-8 px-3 text-xs font-medium ${s.id===a.id?"bg-white text-gray-900 border border-gray-300 hover:bg-gray-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 border border-transparent"}`,onClick:()=>o(a),children:a.label},a.id))}),e.jsx("div",{className:"h-[400px] w-full",children:p?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-3 text-gray-500",children:[e.jsx(se,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{children:"Loading chart..."})]}):b?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-4 text-center",children:[e.jsx("p",{className:"text-red-600 font-medium",children:b}),e.jsxs("p",{className:"text-xs text-gray-500 max-w-md",children:["API: query1.finance.yahoo.com/v8/finance/chart/",t,"?range=",s.range,"&interval=",s.interval]}),e.jsx(L,{variant:"outline",size:"sm",onClick:h,children:"Retry"})]}):n.length===0?e.jsx("div",{className:"flex h-full items-center justify-center text-gray-500",children:"No data available"}):e.jsx(re,{width:"100%",height:"100%",children:e.jsxs(ie,{data:n,margin:{top:8,right:8,left:8,bottom:8},children:[e.jsx(oe,{strokeDasharray:"3 3",stroke:"#f0f0f0",vertical:!1}),e.jsx(ce,{dataKey:"date",tick:{fontSize:11,fill:"#6b7280"},axisLine:!1,tickLine:!1,interval:Math.max(0,Math.floor((n.length-1)/4)),tickFormatter:(a,x)=>x===0?"":a}),e.jsx(le,{domain:["auto","auto"],tick:{fontSize:11,fill:"#6b7280"},axisLine:!1,tickLine:!1,tickFormatter:a=>String(Math.round(a)),tickCount:4,allowDecimals:!1,width:40}),e.jsx(de,{content:e.jsx(ue,{range:s.range}),cursor:{stroke:"#d1d5db",strokeDasharray:"4 4"}}),e.jsx(me,{type:"monotone",dataKey:"close",stroke:C,strokeWidth:2,dot:!1,activeDot:{r:4,fill:C,strokeWidth:0},isAnimationActive:!0})]})})})]})}),e.jsxs(P,{className:"mb-6 border-blue-200 bg-blue-50",children:[e.jsx(E,{children:e.jsxs(F,{className:"flex items-center gap-2 text-blue-900",children:[e.jsx(te,{className:"w-5 h-5"}),"AI Brief · Holdings Impact for ",t,e.jsx(I,{variant:"outline",className:"ml-auto bg-white/80",children:"Gemini + RAG"}),e.jsx(I,{variant:"outline",className:"bg-white/80",children:"Evidence Mode"})]})}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-3",children:[T.map((a,x)=>e.jsxs("div",{className:"p-3 bg-white rounded-lg border border-blue-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:a.theme}),e.jsx(I,{variant:a.sentiment==="Positive"?"default":"secondary",className:a.sentiment==="Positive"?"bg-green-100 text-green-800 border-0":"",children:a.sentiment})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsxs("span",{children:[a.articles," articles analyzed"]})]})]},x)),e.jsx(G,{className:"bg-blue-200"}),e.jsx("div",{className:"p-4 bg-white rounded-lg border border-blue-500/20",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Overall Sentiment Trend:"})," Positive momentum driven by strong earnings and AI product announcements. Watch for supply chain updates in coming weeks."]})}),e.jsx(O,{items:V})]})})]}),e.jsxs(P,{className:"mb-6 border-purple-200 bg-purple-50",children:[e.jsx(E,{children:e.jsxs(F,{className:"flex items-center gap-2 text-purple-900",children:[e.jsx(ne,{className:"w-5 h-5"}),"Impact on Your Holdings"]})}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-3",children:[M.map((a,x)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-purple-600/20",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:a.metric}),e.jsx("span",{className:"text-sm text-gray-900",children:a.value})]},x)),e.jsx(G,{className:"bg-purple-200"}),e.jsx("div",{className:"p-4 bg-white rounded-lg border border-purple-600/20",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Portfolio Impact:"})," This stock represents 35% of your portfolio. A 1% move in ",t," translates to ~0.35% portfolio move. Consider the high correlation with other tech holdings."]})})]})})]}),e.jsx(P,{children:e.jsx(D,{className:"pt-6",children:e.jsxs(B,{defaultValue:"fundamentals",children:[e.jsxs(J,{className:"grid w-full grid-cols-2",children:[e.jsx(R,{value:"fundamentals",children:"Fundamentals"}),e.jsx(R,{value:"technical",children:"Technical"})]}),e.jsx($,{value:"fundamentals",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Market Cap"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:"$2.85T"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"P/E Ratio"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:"29.4"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"EPS (TTM)"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:"$6.20"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Dividend Yield"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:"0.52%"})]})]})}),e.jsx($,{value:"technical",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Key Technical Levels"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Resistance"}),e.jsx("span",{className:"text-sm font-medium text-red-600",children:"$190.00"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Current"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",typeof i.price=="number"?i.price.toFixed(2):"—"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Support"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"$175.00"})]})]})]})})]})})})]})}export{Se as Stock};
