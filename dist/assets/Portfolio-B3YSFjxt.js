import{r as f,j as e}from"./vendor-W84mhc-l.js";import{u as b,a as v,B as x,E as w}from"./index-BRQ3_4kF.js";import{a as P}from"./router-C1wKTLYl.js";import{C as h,c as u,a as p,b as j}from"./card-CpwL0RW4.js";import{R as C,P as S,a as T,C as k,T as L}from"./recharts-DzyiCK6h.js";import{D as A,a as B,b as F,c as $}from"./dialog-Bor2lZTe.js";import{S as g}from"./separator-CEasVtJw.js";import{j as D,S as M,T as R,e as E,k as G}from"./icons-DPUJRDi7.js";import"./radix-CnjOkeCj.js";const y=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"];function H({holdings:i}){const o=P(),d=f.useMemo(()=>{const s=i.reduce((a,c)=>a+c.value,0);return i.map(a=>({ticker:a.symbol,name:a.name,value:a.value,allocation:s>0?a.value/s*100:0}))},[i]);return i.length?e.jsx(h,{className:"border border-gray-200",children:e.jsxs(u,{className:"pt-6",children:[e.jsx("p",{className:"text-base font-semibold text-gray-900 mb-4",children:"Portfolio Allocation"}),e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(S,{children:[e.jsx(T,{data:d,dataKey:"value",nameKey:"ticker",cx:"50%",cy:"50%",outerRadius:100,paddingAngle:2,label:!1,onClick:s=>(s==null?void 0:s.ticker)&&o(`/stock/${s.ticker}`),style:{cursor:"pointer"},children:d.map((s,a)=>e.jsx(k,{fill:y[a%y.length]},`cell-${a}`))}),e.jsx(L,{content:({active:s,payload:a})=>{var n;if(!s||!(a!=null&&a[0]))return null;const c=a[0].payload;return e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white px-3 py-2 shadow-lg text-sm",children:[e.jsx("p",{className:"font-medium text-gray-900",children:c.ticker}),e.jsx("p",{className:"text-gray-600",children:c.name}),e.jsxs("p",{className:"mt-1",children:["$",(c.value??0).toLocaleString("en-US",{minimumFractionDigits:2})," (",(n=c.allocation)==null?void 0:n.toFixed(1),"%)"]})]})}})]})})})]})}):e.jsx(h,{className:"border border-gray-200",children:e.jsxs(u,{className:"pt-6",children:[e.jsx("p",{className:"text-base font-semibold text-gray-900 mb-4",children:"Portfolio Allocation"}),e.jsx("div",{className:"h-[300px] flex items-center justify-center rounded-lg border border-dashed border-gray-300 bg-gray-50",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No portfolio data available"})})]})})}const O={NVDA:[{id:"nvda-1",date:"2025-06-15",type:"Buy",shares:10,purchasePrice:520},{id:"nvda-2",date:"2025-11-20",type:"Buy",shares:6,purchasePrice:680}],TSLA:[{id:"tsla-1",date:"2025-01-10",type:"Buy",shares:25,purchasePrice:210},{id:"tsla-2",date:"2025-08-05",type:"Buy",shares:15,purchasePrice:225}],MSFT:[{id:"msft-1",date:"2025-02-18",type:"Buy",shares:12,purchasePrice:375},{id:"msft-2",date:"2025-10-12",type:"Buy",shares:9,purchasePrice:395}],GOOGL:[{id:"googl-1",date:"2025-03-22",type:"Buy",shares:25,purchasePrice:135},{id:"googl-2",date:"2025-09-08",type:"Buy",shares:15,purchasePrice:145}],META:[{id:"meta-1",date:"2025-04-14",type:"Buy",shares:4,purchasePrice:565},{id:"meta-2",date:"2025-12-01",type:"Buy",shares:3,purchasePrice:595}],AAPL:[{id:"aapl-1",date:"2025-01-15",type:"Buy",shares:20,purchasePrice:245.3},{id:"aapl-2",date:"2025-12-10",type:"Buy",shares:11,purchasePrice:268.5}],JPM:[{id:"jpm-1",date:"2025-05-20",type:"Buy",shares:10,purchasePrice:195},{id:"jpm-2",date:"2025-11-15",type:"Buy",shares:6,purchasePrice:208}]};function U({open:i,onOpenChange:o,ticker:d,companyName:s,currentPrice:a}){const c=O[d]??[],n=c.reduce((l,r)=>l+r.shares*r.purchasePrice,0),t=c.reduce((l,r)=>l+r.shares*a,0),m=n>0?(t-n)/n*100:0;return e.jsx(A,{open:i,onOpenChange:o,children:e.jsxs(B,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[e.jsx(F,{children:e.jsxs($,{children:[d," Transaction History"]})}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:s}),e.jsxs("div",{className:" rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-4 px-4 py-3 text-xs font-medium text-gray-500 bg-gray-50 border-b",children:[e.jsx("div",{children:"Date"}),e.jsx("div",{children:"Type"}),e.jsx("div",{className:"text-right",children:"Shares"}),e.jsx("div",{className:"text-right",children:"Purchase"}),e.jsx("div",{className:"text-right",children:"Current"}),e.jsx("div",{className:"text-right",children:"Gain/Loss"})]}),c.map(l=>{const r=l.purchasePrice>0?(a-l.purchasePrice)/l.purchasePrice*100:0;return e.jsxs("div",{className:"grid grid-cols-6 gap-4 px-4 py-3 text-sm border-b last:border-b-0 hover:bg-gray-50",children:[e.jsx("div",{children:l.date}),e.jsx("div",{children:l.type}),e.jsx("div",{className:"text-right",children:l.shares}),e.jsxs("div",{className:"text-right",children:["$",l.purchasePrice.toFixed(2)]}),e.jsxs("div",{className:"text-right",children:["$",a.toFixed(2)]}),e.jsxs("div",{className:`text-right font-medium ${r>=0?"text-green-600":"text-red-600"}`,children:[r>=0?"+":"",r.toFixed(2),"%"]})]},l.id)})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-gray-50 border border-gray-200 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Investment"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["$",n.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Current Value"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["$",t.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t",children:[e.jsx("span",{className:"text-gray-600",children:"Overall Gain/Loss"}),e.jsxs("span",{className:`font-semibold ${m>=0?"text-green-600":"text-red-600"}`,children:[m>=0?"+":"",m.toFixed(2),"%"]})]})]})]})]})})}function V(i){if(!i)return"Loading...";const o=new Date(i),s=Date.now()-i;return s<6e4?"Just now":s<36e5?`${Math.floor(s/6e4)} min ago`:o.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}function X(){var n;const{holdings:i,totalValue:o,lastUpdatedAt:d}=b(),[s,a]=f.useState(null),c=[{source:"Portfolio PnL",evidence:"Weekly portfolio gains were driven by tech, while energy was a drag.",confidence:"High"},{source:"Benchmark Check",evidence:"The portfolio outperformed its benchmark this week, with excess return mostly from AAPL/MSFT.",confidence:"Medium"},{source:"RAG News Context",evidence:"Retrieved 12 news items and 5 earnings summaries supporting this weekly brief.",confidence:"Medium"}];return e.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Portfolio"}),e.jsxs("p",{className:"text-gray-500 mt-1",children:["Total Value: $",o.toLocaleString("en-US",{minimumFractionDigits:2}),d&&e.jsxs("span",{className:"ml-2 text-xs",children:["· Last updated: ",V(d)]})]})]}),e.jsxs(v,{variant:"outline",size:"sm",className:"self-start sm:self-center",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Edit Holdings"]})]}),e.jsxs(h,{className:"mb-6 border-blue-200 bg-blue-50",children:[e.jsx(p,{children:e.jsxs(j,{className:"flex items-center gap-2 text-blue-900",children:[e.jsx(M,{className:"w-5 h-5"}),"AI Brief · Portfolio Overview",e.jsx(x,{variant:"outline",className:"ml-auto bg-white/80",children:"Gemini + RAG"}),e.jsx(x,{variant:"outline",className:"bg-white/80",children:"Evidence Mode"})]})}),e.jsx(u,{className:"text-blue-900",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"font-medium",children:"Portfolio up 5.2% this week"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-white border border-blue-500/20 mt-4",children:[e.jsx("p",{className:"text-xs font-semibold text-[#1e40af] uppercase tracking-wider mb-2",children:"Insight"}),e.jsx("p",{className:"text-sm leading-relaxed text-gray-700 mb-3",children:"Driven by strong tech earnings and energy recovery. Your portfolio outperformed S&P 500 by 2.1% this week. Consider rebalancing tech allocation which has grown to 65% of total holdings."}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("span",{children:"12 articles analyzed"}),e.jsx("span",{children:"•"}),e.jsx("span",{children:"5 earnings reports reviewed"})]})]}),e.jsx(g,{className:"bg-blue-200"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Key Drivers"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(x,{variant:"secondary",className:"bg-white",children:"Tech: +7.1%"}),e.jsx(x,{variant:"secondary",className:"bg-white",children:"Finance: +2.3%"}),e.jsx(x,{variant:"secondary",className:"bg-white",children:"Energy: -1.2%"})]})]})]}),e.jsx(g,{className:"bg-blue-200"}),e.jsx(w,{items:c})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsx(H,{holdings:i}),e.jsxs(h,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(p,{children:e.jsxs(j,{className:"flex items-center gap-2 text-yellow-900",children:[e.jsx(G,{className:"w-5 h-5"}),"Concentration Alerts"]})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-yellow-900",children:"Tech Sector"}),e.jsx(x,{variant:"destructive",className:"border-0",children:"High Risk"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-1",children:e.jsx("div",{className:"h-2 rounded-full bg-red-500",style:{width:"65%"}})}),e.jsx("p",{className:"text-xs text-yellow-700",children:"65% of portfolio (Target: 40-50%)"})]}),e.jsx(g,{className:"bg-yellow-200"}),e.jsxs("div",{className:"p-4 rounded-lg bg-white border border-blue-500/20 mt-4",children:[e.jsx("p",{className:"text-xs font-semibold text-[#1e40af] uppercase tracking-wider mb-2",children:"Recommendation"}),e.jsx("p",{className:"text-sm leading-relaxed text-stone-600",children:"Consider taking some profits from AAPL or MSFT and diversifying into healthcare or consumer goods sectors."})]})]})})]})]}),e.jsxs(h,{children:[e.jsx(p,{children:e.jsx(j,{children:"Current Holdings"})}),e.jsxs(u,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid grid-cols-7 gap-4 px-4 py-2 text-xs font-medium text-gray-500 border-b",children:[e.jsx("div",{className:"col-span-2",children:"Symbol"}),e.jsx("div",{className:"text-right",children:"Shares"}),e.jsx("div",{className:"text-right",children:"Avg Cost"}),e.jsx("div",{className:"text-right",children:"Current"}),e.jsx("div",{className:"text-right",children:"Gain/Loss"}),e.jsx("div",{className:"text-right",children:"Allocation"})]}),i.map(t=>{const m=t.shares*t.avgCost,r=t.value-m,N=r/m*100;return e.jsxs("button",{type:"button",onClick:()=>a({ticker:t.symbol,name:t.name}),className:"w-full grid grid-cols-7 gap-4 px-4 py-3 hover:bg-gray-50 rounded-lg transition-colors text-left cursor-pointer",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.symbol}),e.jsx("p",{className:"text-xs text-gray-500",children:t.name})]}),e.jsx("div",{className:"text-right text-sm text-gray-900",children:t.shares}),e.jsxs("div",{className:"text-right text-sm text-gray-900",children:["$",t.avgCost.toFixed(2)]}),e.jsxs("div",{className:"text-right text-sm text-gray-900",children:["$",t.currentPrice.toFixed(2)]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-medium ${r>=0?"text-green-600":"text-red-600"}`,children:[r>=0?"+":"","$",r.toFixed(2)]}),e.jsxs("p",{className:`text-xs ${r>=0?"text-green-600":"text-red-600"}`,children:[r>=0?"+":"",N.toFixed(2),"%"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full bg-blue-600",style:{width:`${t.allocation}%`}})}),e.jsxs("span",{className:"text-xs text-gray-600",children:[t.allocation.toFixed(1),"%"]})]})})]},t.symbol)})]}),e.jsx(g,{className:"my-4"}),e.jsx("div",{className:"px-4 py-2 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"Total Portfolio Value"}),e.jsxs("span",{className:"text-xl font-semibold text-gray-900",children:["$",o.toLocaleString("en-US",{minimumFractionDigits:2})]})]})})]})]}),s&&e.jsx(U,{open:!!s,onOpenChange:t=>!t&&a(null),ticker:s.ticker,companyName:s.name,currentPrice:((n=i.find(t=>t.symbol===s.ticker))==null?void 0:n.currentPrice)??0})]})}export{X as Portfolio};
